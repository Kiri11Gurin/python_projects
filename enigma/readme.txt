У нас есть N разных роторов (не обязательно, но как правило) и отражатель.

Сигнал проходит через роторы последовательно. Т.е. внутри ротора происходит замена одного символа на другой согласно спецификации ротора (реализовано 4 таких).

Далее сигнал передаётся с одного Ротора на другой. При этом Роторы могут быть как совмещены (т.е. напротив каждого выходного символа 1 ротора стоит такой же символ 2 ротора), так и смещены (по сути, это шифрование Цезаря с каким-то сдвигом).

Сигнал доходит до отражателя, на котором так же шифруется.

Сигнал начинает обратное путешествие по роторам, шифруясь на каждом из них (с обратным смещением), а так же, если роторы не совмещены, то шифруясь шифром Цезаря при переходе от одного Ротора к другому.

В настоящей энигме задаётся не смещение роторов относительно друг друга, а положение роторов относительно оси. Фактически это значит, что шифр цезаря применяется не только при переходе сигнала с ротора на ротор, но и ПЕРЕД попаданием сигнала с клавиатуры на самый правый ротор, а так же ПОСЛЕ прохождения правого ротора (перед выходом).

Будем задавать положением каждого ротора числом (от 0 до 25).

Положительное смещение ротора по дороге "туда" превращается в отрицательное смещение по дороге "обратно".

- Смещение при попадании на правый ротор с клавиатуры равно смещению ротора относительно оси
- Смещение при попадании с одного ротора на другой равно разности между смещения роторов относительно оси
- Смещение при попадании с левого ротора на отражатель равно смещению этого ротора относительно оси и обратно по знаку
- Смещение при попадании с правого ротора на индикатор (на выход) равно смещению ротора относительно оси и обратно по знаку

После нажатия клавиши на клавиатуре и до передачи её на правый ротор он сдвигается на 1 позицию при каждом нажатии на любую кнопку. Т.е. если в начале процесса шифрования положение ротора было 0, то уже первый символ шифруется со смещением +1 на правом роторе. Следующий символ шифруется со смещением +2. И т.д.

У каждого ротора есть специальный механизм, позволяющий повернуть соседний (находящийся левее) ротор при определённых условиях. Условием является достижение определённого смещения:

Rotor I			at R		при смещении 17
Rotor II		at F		при смещении 5
Rotor III		at W		при смещении 22
Rotor IV		at K		при смещении 10
Rotor V			at A		при смещении 0
Rotors VI, VII and VIII	at A and at N	при смещении 0 или 13

Т.е. Если правый ротор - 3, со смещением 0 в начальный момент, то при каждом нажатии клавиши его собственное смещение увеличивается на 1. Как только мы нажмём 22-ой раз любую клавишу (т.е. подадим любой символ на кодирование), то на 1 увеличится смещением правого ротора И на 1 увеличится смещение центрального ротора (Ротор 3 повернёт соседа на 1).

Примечание. Если любой ротор в процессе движения попадает на позицию предшествующую той, которая повернёт соседа, то на следующий шаг он повернётся ещё раз и повернёт соседа.

Пример:
Все роторы - II.
Положение всех роторов +3
II (+3), II (+3), II (+3)

Вводим 1 символ. Правый Ротор поворачивается на 1:
II (+3), II (+3), II (+4)

Следующий ввод переведёт правый ротор в позицию, из которой он поворачивает на 1 соседа - центральный ротор.
Вводим 1 символ. Правый и Центральный Роторы поворачиваются на 1:
II (+3), II (+4), II (+5)

Центральный Ротор попал на позицию предшествующую поворотной. Следовательно он получает "право второго хода" - при следующем вводе он повернётся сам, и повернёт соседа (левый ротор) + по обычному правилу повернётся правый ротор.
Вводим 1 символ. ВСЕ Роторы поворачиваются на 1:
II (+4), II (+5), II (+6)

Дальше будет поворачиваться только правый Ротор до тех пор, пока снова не выйдет на позицию, позволяющую повернуть центральный.

Энигма также шифруется с помощью коммутационной панели (попарное соединение букв с помощью гибких проводов).
Соединяя их попарно проводами оператор производит замену (в каждой такой паре) ДО отправки на шифрование и ПОСЛЕ.
Т.е. в латинском алфавите 26 символов, это значит, что все гнёзда могут быть заняты. Так же все гнёзда могут быть свободны, либо скоммутированы могут быть только часть гнёзд.

Если какие-то символы не коммутированы, то для них не производится замена.
Предположим, у нас используются Роторы 1, 2, 3 и отражатель типа "B", без начального смещения.

Обычно при таком шифровании из символа "A" получаем "B".
Скоммутируем 2 символа: "A" и "С".
Теперь ПЕРЕД шифрованием "A" превратится в "C". "C" зашифруется в "Q".

Если бы мы скоммутировали 2 пары символов: "A" и "C" + "Q" и "D", то процесс выглядел бы так:
ПЕРЕД шифрованием "A" превратится в "C".
"C" шифруется в "Q".
ПОСЛЕ шифрования "Q" превращается в "D".